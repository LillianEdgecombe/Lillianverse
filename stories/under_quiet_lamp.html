<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Lillianverse Story</title>
  <link rel="stylesheet" href="../assets/style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
</head>
<body>
  <nav>
    <a href="../index.html">Home</a>
    <a href="../project.html">About</a>
    <a href="../hub1.html">First Hub</a>
    <a href="../hub2.html">Main Station</a>
  </nav>
  <main>
    <h1 id="story-title"></h1>
    <div id="story-content" class="markdown"></div>
  </main>
  <footer>
    <a href="#" id="discord-link">Discord</a>
    <a href="#" id="kofi-link">Ko-fi</a>
    <a href="#" id="redbubble-link">RedBubble</a>
    <a href="#" id="amazon-link">Amazon KDP</a>
  </footer>
  <script>
    const storyFile = 'under_quiet_lamp.txt';
    const storyTitleEl = document.getElementById('story-title');
    const storyContentEl = document.getElementById('story-content');

    fetch(storyFile)
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.text();
      })
      .then(text => {
        const lines = text.split('\n');
        const title = lines.length > 0 ? lines[0].replace('## ', '').trim() : 'Untitled Story';
        const storyMarkdown = lines.slice(1).join('\n');

        storyTitleEl.textContent = title;
        document.title = title + ' | Lillianverse';

        const converter = new showdown.Converter({noHeaderId: true});
        const html = converter.makeHtml(storyMarkdown);
        storyContentEl.innerHTML = html;
      })
      .catch(error => {
        storyContentEl.innerHTML = `<p>Error loading story: ${error}. Please check the file path and make sure the file is accessible.</p>`;
      });
  </script>
</body>
</html>